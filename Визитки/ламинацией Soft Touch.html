<!-- Визитки с ламинацией Soft Touch в типографии ФиПС -->

<style>
	.t-form__screen-wrapper .t-input-group_rd + .t-input-group_in {
		width: 10%;
	}

	.t-form__screen-wrapper .t-input-group_rd + .t-input-group_in + .t-input-group_in {
		width: 10%;
	}

	.t-form__screen-wrapper .t-input-group_rd + .t-input-group_in .t-input-block {
		width: 50%;
	}

	.t-form__screen-wrapper .t-input-group_rd + .t-input-group_in + .t-input-group_in .t-input-block {
		width: 50%;
	}

	.t-form__screen-wrapper_active .t-input-block .t-input,
	.t-form__screen-wrapper_active .t-input-block .t-select {
		height: 40px;
		border-radius: 5px;
	}

	.t-form__screen .t-form__errorbox-wrapper {
		clear: both;
	}

	.t-form__inputsbox.t-form__screen {
		background-color: #fff;
		padding: 20px;
	}

	.t-form__screen .t-upwidget-container__button {
		background-color: #44647d !important;
	}

	.t-form__screen .t-input-group_fr {
		text-align: right;
	}

	.t-form__screen .t-form__submit {
		margin: 30px 0 0;
	}

	.t-form__screen .t-input-group {
		display: flex;
		flex-wrap: wrap;
		align-content: flex-start;
		margin: 0;
		width: 20%;
		min-width: 200px;
	}

	.t-form__screen .t-input-title {
		width: 100%;
		height: auto;
	}

	.t-form__screen-wrapper.t-form__screen-wrapper_active {
		display: flex !important;
		flex-wrap: wrap;
		justify-content: space-between;
	}

	.t-form__screen .t-input-group.t-input-group_fr {
		text-align: right;
		justify-content: flex-end;
		width: 100%;
		margin-bottom: 0;
	}

	.t-form__screen .t-input-group.t-input-group_uw+.t-input-group.t-input-group_fr {
		width: 50%;
		align-content: flex-end;
	}

	.t-form__screen .t-input-group.t-input-group_tx {
		width: 100%;
	}

	.t-form__screen-wrapper_active .t-input-block {
		width: 100%;
	}

	.t-form__screen-wrapper_active .t-input-block .t-input,
	.t-form__screen-wrapper_active .t-input-block .t-select {
		width: 90%;
	}

	.t-form__screen .t-form__screen-wrapper_active .t-input-group_cb, 
	.t-form__screen .t-form__screen-wrapper_active .t-input-group_uw {
    width: 10%;
    min-width: 290px;
    margin-bottom: 0;
}

	.t-form__screen .t-input-group_ph,
	.t-form__screen .t-input-group_sb,
	.t-form__screen .t-input-group_in,
	.t-form__screen .t-input-group_em,
	.t-form__screen .t-input-group_nm,
	.t-form__screen .t-input-group_uw {
		width: 50%;
		margin-right: 0;
	}

	.t-form__screen .t-input-group_in[data-input-lid="1584868297796"] {
		width: 20%;
	}

	.t-form__screen .sepcial-flex-wrapper {
		width: 50%;
		display: flex;
		flex-wrap: nowrap;
		align-items: center;
	}

	.t-form__screen .sepcial-flex-wrapper .t-input-group_cb {
		position: relative;
		top: 10px;
		left: -80px;
	}

	.t-form__screen .t-input-group.t-input-group_cb .t-text_xs {
		font-size: 15px;
	}

	.t-form__screen .t-form__submit .t-form__screen-btn-next {
    	padding: 0 30px 0 10px;
	}
	.t-form__screen .t-form__submit .t-form__screen-btn-prev {
		padding: 0 10px 0 30px;
	}
	.t-form__screen .t-form__submit .t-submit{
		padding: 0 10px;
	}
	.t-form__screen .t-input-group{
		margin-bottom: 25px;	
	}
	.t-form__screen .t-select__wrapper:after{
		right: 70px;
	}

	@media screen and (max-width: 700px) {
		.t-form__screen .t-input-group.t-input-group_fr {
			text-align: center;
			justify-content: center;
		}

		.t-form__screen .t-input-group_ph,
		.t-form__screen .t-input-group_sb,
		.t-form__screen .t-input-group_in,
		.t-form__screen .t-input-group_em,
		.t-form__screen .t-input-group_nm,
		.t-form__screen .t-input-group_uw {
			width: 100%;
			justify-content: center;
		}

		.t-form__screen-wrapper.t-form__screen-wrapper_active {
			justify-content: center;
		}

		.t-form__screen .t-input-group_uw {
			text-align: center;
		}

		.t-form__screen .t-input-group_uw .t-input-block {
			display: flex;
			justify-content: center;
		}

		.t-form__screen .t-input-group.t-input-group_uw+.t-input-group.t-input-group_fr {
			width: 100%;
		}

		.t-form__screen .t-form__screen-btn-prev {
			margin-right: 0;
		}

		.t-form__screen .sepcial-flex-wrapper {
			justify-content: center;
			width: 100%;
			flex-wrap: wrap;
		}

		.t-form__screen .sepcial-flex-wrapper .t-input-block {
			width: auto;
			display: flex;
		}

		.t-form__screen .sepcial-flex-wrapper .t-input-group_cb {
			position: inherit;
			justify-content: center;
			margin: 10px 0 15px;
		}
	}
	@media screen and (max-width: 460px){
		.t-form__screen .t-form__submit > .t-form__screen-btn-prev {
			margin-bottom: 15px;
			padding: 10px;
		}
		.t-form__screen .t-select__wrapper:after {
			right: 40px;
		}
	}
</style>
<script>
	$(document).ready(function () {
        //$('[data-input-lid="1587736385407"]').css("display", "none"); // убираем пункт (решение директора) 
		try {
			setTimeout(function () {
				$('.t-form__screen-current-view').remove();
				$('.t-form__screen-wrapper .t-input-group_uw, .t-form__screen-wrapper .t-input-group_uw + .t-input-group_cb').wrapAll('<div class="sepcial-flex-wrapper"></div>');
				$('[data-input-lid="1585849157154"] .t-input.js-tilda-rule').val('1');

				function updateFinalPrice() {

					if (column == 0) {
						rangeVal = 100;
					}
					let final_price = Math.floor(table[size][row][column] * Math.ceil(rangeVal / 50) * 50 * numberOfSets);

					if (roundedCorners) {
						final_price += Math.floor(table[size][5][column] * Math.ceil(rangeVal / 50) * 50 * numberOfSets);
					}

					$('[data-input-lid="1584868418389"] .t-calc').html(`<s>${Math.floor(final_price)} руб</s> <span style="color:white;">с НДС</span><br/>${Math.floor(final_price * 0.93)}`);
					$('[data-input-lid="1584868661139"] .t-calc').text(Math.floor(final_price * 0.93));
					$('[data-input-lid="1584868418389"] [name="Formula"]').attr('value', Math.floor(final_price));
                	$('[data-input-lid="1584868661139"] [name="Formula_2"]').attr('value', Math.floor(final_price * 0.93));
				}

				//определение переменных
				const table_300 = [
					[
						// Визитки Soft touch 90*50 - стандарт
						[100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000], // Цветность\Количество
						[12.38, 11.51, 10.36, 9.84, 9.35, 9, 8.66, 8.34, 8.01, 7.77, 7.56, 7.38, 7.22, 7.09, 6.99, 6.93, 6.88, 6.85, 6.83], // Односторонние цветные (4+0)
						[13.19, 12.27, 11.04, 10.49, 9.96, 9.59, 9.23, 8.89, 8.58, 8.32, 8.1, 7.9, 7.74, 7.6, 7.49, 7.42, 7.37, 7.33, 7.32], // Двусторонние цветные (4+4)
						[13.56, 12.61, 11.35, 10.78, 10.24, 9.85, 9.49, 9.14, 8.82, 8.55, 8.32, 8.12, 7.95, 7.81, 7.7, 7.63, 7.58, 7.54, 7.52], // Запечатка фона (4+0)
						[14.15, 13.16, 11.84, 11.25, 10.69, 10.28, 9.9, 9.54, 9.2, 8.93, 8.68, 8.48, 8.3, 8.15, 8.04, 7.96, 7.91, 7.87, 7.85], // Запечатка фона (4+4)
						[2.09, 1.99, 1.79, 1.7, 1.61, 1.55, 1.49, 1.44, 1.4, 1.37, 1.35, 1.33, 1.31, 1.3, 1.28, 1.26, 1.24, 1.22, 1.21] // Скругление углов
					],
					[
						// Визитки Soft touch 85*55 - евро
						[100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000], // Цветность\Количество
						[12.75, 11.86, 10.91, 10.36, 9.85, 9.47, 9.12, 8.78, 8.43, 8.18, 7.96, 7.77, 7.6, 7.47, 7.36, 7.3, 7.25, 7.21, 7.19], // Односторонние цветные (4+0)
						[13.64, 12.69, 11.67, 11.09, 10.53, 10.13, 9.76, 9.4, 9.07, 8.8, 8.56, 8.35, 8.18, 8.03, 7.92, 7.85, 7.79, 7.75, 7.74], // Двусторонние цветные (4+4)
						[13.93, 12.95, 11.92, 11.32, 10.76, 10.35, 9.96, 9.6, 9.26, 8.98, 8.74, 8.53, 8.35, 8.2, 8.09, 8.01, 7.96, 7.92, 7.9], // Запечатка фона (4+0)
						[14.65, 13.62, 12.53, 11.91, 11.31, 10.88, 10.48, 10.09, 9.74, 9.45, 9.19, 8.97, 8.78, 8.62, 8.5, 8.43, 8.37, 8.33, 8.31], // Запечатка фона (4+4)
						[2.09, 1.99, 1.83, 1.74, 1.65, 1.59, 1.53, 1.47, 1.43, 1.4, 1.38, 1.36, 1.34, 1.32, 1.31, 1.29, 1.27, 1.25, 1.23] // Скругление углов
					]
				];
				const table_350 = [
					[
						// Визитки Soft touch 90*50 - стандарт
						[100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000], // Цветность\Количество
						[13.05, 12.14, 10.92, 10.38, 9.86, 9.48, 9.13, 8.79, 8.44, 8.19, 7.97, 7.78, 7.61, 7.48, 7.37, 7.31, 7.25, 7.22, 7.2], // Односторонние цветные (4+0)
						[13.89, 12.92, 11.63, 11.04, 10.49, 10.09, 9.72, 9.36, 9.03, 8.76, 8.53, 8.32, 8.15, 8, 7.89, 7.82, 7.76, 7.72, 7.71], // Двусторонние цветные (4+4)
						[14.28, 13.28, 11.95, 11.35, 10.79, 10.38, 9.99, 9.62, 9.29, 9.01, 8.76, 8.55, 8.37, 8.22, 8.11, 8.04, 7.98, 7.94, 7.92], // Запечатка фона (4+0)
						[14.89, 13.85, 12.46, 11.84, 11.25, 10.82, 10.42, 10.03, 9.68, 9.39, 9.14, 8.92, 8.73, 8.58, 8.46, 8.38, 8.32, 8.28, 8.26], // Запечатка фона (4+4)
						[2.09, 1.99, 1.79, 1.7, 1.61, 1.55, 1.49, 1.44, 1.4, 1.37, 1.35, 1.33, 1.31, 1.3, 1.28, 1.26, 1.24, 1.22, 1.21], // Скругление углов
					],
					[
						// Визитки Soft touch 85*55 - евро
						[100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000], // Цветность\Количество
						[13.42, 12.48, 11.48, 10.91, 10.36, 9.97, 9.6, 9.24, 8.88, 8.61, 8.38, 8.18, 8, 7.86, 7.75, 7.68, 7.63, 7.59, 7.57], // Односторонние цветные (4+0)
						[14.36, 13.35, 12.29, 11.67, 11.09, 10.67, 10.27, 9.89, 9.55, 9.26, 9.01, 8.79, 8.61, 8.45, 8.34, 8.26, 8.2, 8.16, 8.15], // Двусторонние цветные (4+4)
						[14.66, 13.63, 12.54, 11.92, 11.32, 10.89, 10.49, 10.1, 9.75, 9.45, 9.2, 8.98, 8.79, 8.63, 8.51, 8.43, 8.37, 8.33, 8.32], // Запечатка фона (4+0)
						[15.42, 14.34, 13.19, 12.53, 11.91, 11.45, 11.03, 10.62, 10.25, 9.94, 9.67, 9.44, 9.24, 9.08, 8.95, 8.87, 8.81, 8.76, 8.75], // Запечатка фона (4+4)
						[2.09, 1.99, 1.83, 1.74, 1.65, 1.59, 1.53, 1.47, 1.43, 1.4, 1.38, 1.36, 1.34, 1.32, 1.31, 1.29, 1.27, 1.25, 1.23], // Скругление углов
					]
				];

				let table = table_300;
				let size = 0;
				let row = 1;
				let column = 0;
				let numberOfSets = 1;
				let rangeVal = 100;
				let roundedCorners = false;

				// eventListeners
				$("#rec176001712").off('change');
				$('.t-select, .t-radio, .t-checkbox, .t-img-select').off('change');
				$(".t-form__screen-wrapper .t-input.js-tilda-rule").off();

				$('[data-input-lid="1594789704972"] .t-radio__wrapper').change(function () { // Бумага
					if ($('[data-input-lid="1594789704972"] .t-radio:eq(0)').prop('checked')) {
						table = table_300;
						updateFinalPrice();
					} else if ($('[data-input-lid="1594789704972"] .t-radio:eq(1)').prop(
						'checked')) {
							table = table_350;
						updateFinalPrice();
					}
				});

				$('[data-input-lid="1584868125487"] .t-radio__wrapper').change(function () { // размер
					if ($('[data-input-lid="1584868125487"] .t-radio:eq(0)').prop('checked')) {
						size = 0;
						updateFinalPrice();
					} else if ($('[data-input-lid="1584868125487"] .t-radio:eq(1)').prop(
						'checked')) {
						size = 1;
						updateFinalPrice();
					}
				});

				$('[data-input-lid="1584868178894"] .t-radio__wrapper').change(function () { // цветность
					$('[data-input-lid="1584868178894"] .t-radio').each(function (index, element) {
						if ($(element).prop('checked')) {
							row = +index + 1;
							updateFinalPrice();
						}
					});
				});

				$('[data-input-lid="1584868297796"] .t-input.js-tilda-rule').keyup(function () { // тираж
					rangeVal = $('[data-input-lid="1584868297796"] .t-input.js-tilda-rule').val();
					for (let index = 0; index < table[size][0].length; index++) {
						if (rangeVal < 0 || !parseInt(rangeVal)) {
							$('[data-input-lid="1584868297796"] .t-input.js-tilda-rule').val('');
							break;
						} else if (rangeVal <= table[size][0][index]) {
							column = index;
							break;
						} else if (rangeVal > table[size][0][table[size][0].length - 1]) {
							column = table[size][0].length - 1;
							break;
						}
					}
					updateFinalPrice();
				});

				$('[data-input-lid="1585849157154"] .t-input.js-tilda-rule').keyup(function () { // кол-во комплектов
					numberOfSets = $('[data-input-lid="1585849157154"] .t-input.js-tilda-rule').val();
					if(timeTitle != '00 : 00 : 00 : 00'){ numberOfSets = numberOfSets - Math.trunc((numberOfSets/3)) }; // акция каждый 3 бесплатно
					if (numberOfSets < 0 || !parseInt(numberOfSets) || isNaN(numberOfSets)) {
						$('[data-input-lid="1585849157154"] .t-input.js-tilda-rule').val('');
						numberOfSets = 1;
					}
					updateFinalPrice();
				});

				$('[data-input-lid="1587736385407"] .t-checkboxes__wrapper').change(function () { // допы
					if ($(
							'[data-input-lid="1587736385407"] .t-checkboxes__wrapper [value="Скругление углов"]')
						.prop('checked')) {
						roundedCorners = $(
							'[data-input-lid="1587736385407"] .t-checkboxes__wrapper [value="Скругление углов"]'
							).prop('checked');
						updateFinalPrice();
					} else {
						roundedCorners = $(
							'[data-input-lid="1587736385407"] .t-checkboxes__wrapper [value="Скругление углов"]'
							).prop('checked');
						updateFinalPrice();
					}
				});

				setInterval(updateFinalPrice, 100);
			}, 1000);
		} catch (err) {}
	});
</script>